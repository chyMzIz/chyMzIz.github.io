<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>About VMware&#39;s Service</title>
      <link href="2020/09/24/About-VMware-s-Service/"/>
      <url>2020/09/24/About-VMware-s-Service/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>最近突然发现VMware的服务不守规矩，开机就侯在那了，虽然吧，加一加没占多少内存，但就是看着老不舒服。😶  </p><img src="/2020/09/24/About-VMware-s-Service/1.png" class="" title="Process information">  <p>于是想着能不能让它们动态地在使用VMware时开启，不用时关闭<br>经过一番查询，通过脚本来实现对我来说还是可操作的。（虽然我并不会脚本🙃）</p><h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><p>先是找了些相关教程学习一下。👉 <a href="https://baike.baidu.com/item/%E6%89%B9%E5%A4%84%E7%90%86">批处理</a>  </p><h3 id="v-01"><a href="#v-01" class="headerlink" title="v_01"></a>v_01</h3><p><strong>首先将这些服务的启动类型置为手动</strong>，然后：  </p><p>我的初步想法是：</p><blockquote><p>开机加载该<code>开机脚本</code><br>对进程进行监控，如发现<code>vmware.exe</code>进程（即打开了VMware workstation），则开启对应服务，脚本结束<br>关机前执行<code>关机脚本</code>，关闭这些服务</p></blockquote><p><strong>开机脚本</strong></p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: <span class="built_in">start</span> VMware services when VMware Workstation is turned on</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=vmware.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">:: <span class="built_in">ping</span> localhost -n <span class="number">10</span></span><br><span class="line">timeout /T <span class="number">10</span></span><br><span class="line"></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target_on%</span>&quot; || <span class="keyword">goto</span> Delay</span><br><span class="line"><span class="keyword">goto</span> TurnOn</span><br><span class="line"></span><br><span class="line">:TurnOn</span><br><span class="line">:: <span class="built_in">echo</span> Onnnnnnnnnnnnnnnnnnnnnnnnnn</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">start</span> the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure><p><strong>关机脚本</strong></p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: stop VMware services <span class="built_in">at</span> shutdown</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure><p>然而，在我机子💻上的组策略（百度的方法在家庭版上装的）不知道哪有问题，关机脚本无效…😓，恳请路过大佬解惑🙏<br>开机脚本懒得试，把它丢在了这里 <code>C:\Users\###\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>  </p><h3 id="v-02"><a href="#v-02" class="headerlink" title="v_02"></a>v_02</h3><p>主要是想再多接触一下bat🙃，也是想实现、验证一下脑海中的各种想法是否可行</p><blockquote><p>上述开机脚本是通过<code>进程监控，服务被触发（VMware.exe出现）开启</code><br>于是想着关机脚本是不是也可以模仿一下？！<br>首先想到的肯定也是<code>进程监控，服务被触发（VMware.exe消失）关闭</code><br>这样的话肯定是要<code>开机脚本</code>和<code>关机脚本</code>交替工作  </p><p>就是很不解那组策略😠，必须要实现关机脚本！！！<br>突然想到了 <code>explorer.exe</code>，试一试！！！！</p></blockquote><p><strong>开机脚本</strong></p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="built_in">start</span> /D &quot;C:\Software\VMware&quot; VMwareServiceOff.bat      👈</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure><p><strong>关机脚本</strong></p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: stop VMware services <span class="built_in">at</span> shutdown</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=explorer.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">timeout /T <span class="number">2</span></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target%</span>&quot; || <span class="keyword">goto</span> TurnOff</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOff</span><br><span class="line">:: stop VMware services</span><br><span class="line"></span><br><span class="line">:: explorer都关了，log也打不进去了ba</span><br><span class="line">:: <span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p>其实还是 <code>v_01</code> 吧👇，监控 <code>explorer.exe</code> 的延迟时间不能长，感觉还有点拖慢关机速度。。另外可能还不是百分百命中  </p><p><strong>v_01_fin</strong></p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: <span class="built_in">start</span> VMware services when VMware Workstation is turned on</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=vmware.exe</span><br><span class="line"><span class="built_in">set</span> targetS=vmware-hostd.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt       👈</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">:: <span class="built_in">ping</span> localhost -n <span class="number">8</span></span><br><span class="line">timeout /T <span class="number">8</span></span><br><span class="line"></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target%</span>&quot; || <span class="keyword">goto</span> TurnOff</span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetS%</span>&quot; || <span class="keyword">goto</span> TurnOn</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOn</span><br><span class="line">:: <span class="built_in">echo</span> Onnnnnnnnnnnnnnnnnnnnnnnnnn</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">start</span> the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOff</span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetS%</span>&quot; || <span class="keyword">goto</span> Delay</span><br><span class="line">:: <span class="built_in">echo</span> Offfffffffffffffffffffffff</span><br><span class="line"><span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br></pre></td></tr></table></figure><p>如果可以正确执行，那么<br>如果你需要它开机后台执行，将上述 <code>Run as administrator</code> 代码做如下修改：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">0</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line">:: <span class="number">1</span> -----&gt; <span class="number">0</span></span><br></pre></td></tr></table></figure><p>很需要大佬帮我解读这行代码。👀</p>]]></content>
      
      
      <categories>
          
          <category> bat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VMware </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2020/09/10/hello-world/"/>
      <url>2020/09/10/hello-world/</url>
      
        <content type="html"><![CDATA[<p>写博客的初衷是将其作为日记或笔记，记录关于自己的something。</p><ul><li><p>自记事以来，我的语言、文字表达能力极度不堪，高中以来大大小小的考试作文写够字数的次数<em>只手可数</em>,甚至高考！！！😶，所以也是借此锻炼一下。</p></li><li><p>稀里糊涂地入了<strong>CS</strong>。大学前并未接触💻太多，且多是在game；两年的课程学习中，真真真的是收获极大，但同时也才发现只是刚跨过门槛（或许还在跨ing🙃）。</p></li></ul><p>曾经幻想过自己可能是个geek天才、大牛🐂，只是还没有get到机遇。  </p><p>嗯，，梦终究是梦，现实的大嘴巴子👏，啪啪啪，出奇地响亮。</p><p><strong>地球🌏仍在运转，我们仍要前行。</strong></p><p><strong>Stay Hungry, Stay Foolish!</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Install arch Linux in VMware</title>
      <link href="2020/09/10/Install-arch-Linux-in-VMware/"/>
      <url>2020/09/10/Install-arch-Linux-in-VMware/</url>
      
        <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>暑假里实在无聊，想到有“安装劝退”一说的Arch,应该能打发不少无聊时间吧；<br>一直觉得命令行操作很神圣（炫、酷，<del>~</del>），大学刚开始就装了个来玩，是“对初学者友好”的Ubuntu，也就是按着某N、某书来的，装好后尴尬了😅，不知道该干嘛，高深的咱不懂，简单的一些操作指令敲多了也腻，于是搁置了。直到在装arch这段时间里，通过其优秀的<a href="https://wiki.archlinux.org/">官方文档</a> 👏，辅以博文指导，才于第八次“渡劫”成功🎈，也体会到了其中之妙；<br>我是一名稳健的人儿😁，VMware走起！！!</p><h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><p>Arch的安装其实<a href="https://wiki.archlinux.org/index.php/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Installation guide</a> 已经十分清晰、明了按着指南准没错，然后就是其中遇到的小坑之类的，Google一番，差不多就🆗了。</p><h3 id="Before-you-begin"><a href="#Before-you-begin" class="headerlink" title="Before you begin"></a>Before you begin</h3><h4 id="版本说明"><a href="#版本说明" class="headerlink" title="版本说明"></a>版本说明</h4><p><a href="https://my.vmware.com/cn/web/vmware/downloads/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0#product_downloads">VMware workstation</a> ： <code>VMware® Workstation 15 Pro-15.1.0</code><br><a href="https://www.archlinux.org/download/">Arch Linux ISO</a> ： <code>archlinux-2020.08.01-x86_64</code></p><h4 id="新建虚拟机"><a href="#新建虚拟机" class="headerlink" title="新建虚拟机"></a>新建虚拟机</h4><blockquote><p>客户机操作系统: <code>linux</code><br>版本： <code>其他 Linux 4.x 或更高版本内核 64位</code><br>网络类型： <code>NAT</code><br>磁盘容量： <code>20GB</code><br>处理器数及内核数、内存等选项: <code>推荐or自定</code>  </p></blockquote><h4 id="方案选择"><a href="#方案选择" class="headerlink" title="方案选择"></a>方案选择</h4><p>在正式安装前要先对Linux下<a href="https://wiki.archlinux.org/index.php/Partitioning_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#Master_Boot_Record">分区表、分区方案以及bootloader等点</a> (该wiki很详尽，但概括性强，深入理解还需另外查阅资料)有一定的了解，然后确定自己要安装的Arch的方案；<br>以下本人提供两种方案，可能并不是最优解（因为我对分区相关内容理解也并不深），但行得通，对入门菜鸟来说，差不多了吧。😂  </p><p>方案一：</p><blockquote><p>BIOS + MBR + <a href="https://wiki.archlinux.org/index.php/GRUB">GRUB</a></p></blockquote><p>方案二：</p><blockquote><p><a href="https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface">EFI</a> + GPT + <a href="https://wiki.archlinux.org/index.php/REFInd">rEFInd</a></p></blockquote><h3 id="Begin"><a href="#Begin" class="headerlink" title="Begin"></a>Begin</h3><p>开启此虚拟机<br>但如果选择<strong>方案二</strong>，在开启前👇</p><blockquote><p>进入该虚拟机文件目录，找到 <code>xx.vmx</code> ,使用文本编辑器打开，在文件最底部添加行：</p><blockquote><p><code>firmware = &quot;efi&quot;</code></p></blockquote></blockquote><p>然后可以看到启动界面：<br>方案一：  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/01.png" class="" title="方案一启动界面">  <p>方案二：  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/02.png" class="" title="方案二启动界面">  <p>片刻就进入命令行界面了</p><h4 id="检查网络连接"><a href="#检查网络连接" class="headerlink" title="检查网络连接"></a>检查网络连接</h4><p>使用 <code>ping</code> 命令：  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eg： ping -c 4 www.baidu.com</span><br></pre></td></tr></table></figure><h4 id="更新系统时间"><a href="#更新系统时间" class="headerlink" title="更新系统时间"></a>更新系统时间</h4><p>使用 <code>timedatectl</code> 确保系统时间是准确的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-ntp <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>可以使用 <code>timedatectl status</code> 检查服务状态</p><h4 id="硬盘分区👈"><a href="#硬盘分区👈" class="headerlink" title="硬盘分区👈"></a>硬盘分区👈</h4><h5 id="查看硬盘信息"><a href="#查看硬盘信息" class="headerlink" title="查看硬盘信息"></a>查看硬盘信息</h5><p><code>fdisk -l</code><br>我之前为该虚拟机分配了20GB，如图（请牢记你的硬盘名称，此处我的为 <code>/dev/sda</code> ）：</p><img src="/2020/09/10/Install-arch-Linux-in-VMware/03.png" class="" title="硬盘信息">  <p>结果中以 <code>rom</code>，<code>loop</code> 或者 <code>airoot</code> 结束的可以被忽略</p><h5 id="分区"><a href="#分区" class="headerlink" title="分区"></a><a href="https://wiki.archlinux.org/index.php/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%BB%BA%E7%AB%8B%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA">分区</a></h5><p>分区常用方案</p><blockquote><ul><li>引导分区 /boot：260–512 MiB</li><li>交换分区 swap：虚拟内存，大于 512 MiB</li><li>根目录 /：安装系统和软件，大小自定</li><li>用户home /home：用户文档等所在地，大小自定</li></ul></blockquote><p>我比较中意使用 <code>cdfisk</code>进行分区，键入命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfdisk /dev/sda</span><br></pre></td></tr></table></figure><p>cfdisk使用：</p><blockquote><p>↑ ↓ 切换分区，← → 切换菜单选项；<br>先从 <code>free space</code> <code>new</code> 出分区，<code>new</code> 时确定分区大小，以及分区类型，然后可对该分区进行 <code>type</code> ,<code>bootable</code> 等定义；<br>分区完成后 <code>Write</code> , <code>yes</code>确定, <code>quit</code>即可</p></blockquote><p>然后会出现一道选择题 <code>select label type</code> :<br>毫无疑问，你是方案一就选择 <code>dos</code> ，方案二就选择 <code>gpt</code>  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/04.png" class="" title="select label type">  <p>方案一  分区方案：  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/05.png" class="" title="方案一 分区方案">  <p>方案二  分区方案：  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/06.png" class="" title="方案二 分区方案">  <h4 id="格式化分区"><a href="#格式化分区" class="headerlink" title="格式化分区"></a>格式化分区</h4><p>方案一：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 /dev/sda1</span><br><span class="line">mkswap /dev/sda2</span><br><span class="line">mkfs.ext4 /dev/sda3</span><br><span class="line">swapon /dev/sda2</span><br></pre></td></tr></table></figure><p>方案二：<br>EFI分区需要格式化成FAT32格式（具体见<a href="https://wiki.archlinux.org/index.php/EFI_system_partition">Wiki</a> ）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkfs.vfat -F32 /dev/sda1</span><br><span class="line">mkswap /dev/sda2</span><br><span class="line">mkfs.ext4 /dev/sda3</span><br><span class="line">mkfs.ext4 /dev/sda4</span><br><span class="line">swapon /dev/sda2</span><br></pre></td></tr></table></figure><h4 id="挂载分区"><a href="#挂载分区" class="headerlink" title="挂载分区"></a>挂载分区</h4><p>先挂载根分区</p><p>方案一：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sda3 /mnt</span><br><span class="line">mkdir /mnt/boot</span><br><span class="line">mount /dev/sda1 /mnt/boot</span><br></pre></td></tr></table></figure><p>方案二：  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sda3 /mnt</span><br><span class="line">mkdir /mnt/boot</span><br><span class="line">mkdir /mnt/home</span><br><span class="line">mount /dev/sda1 /mnt/boot</span><br><span class="line">mount /dev/sda4 /mnt/home</span><br></pre></td></tr></table></figure><p><code>lsblk</code>查看是否挂载成功  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/07.png" class="" title="lsblk">  <h4 id="安装必须的软件包"><a href="#安装必须的软件包" class="headerlink" title="安装必须的软件包"></a><a href="https://wiki.archlinux.org/index.php/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%AE%89%E8%A3%85%E5%BF%85%E9%A1%BB%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85">安装必须的软件包</a></h4><p>镜像源这个我没换也是ok的，所以，过！  </p><p>键入命令：  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacstrap /mnt base linux linux-firmware vim</span><br></pre></td></tr></table></figure><p><code>base-devel</code> 这个看个人了 <a href="https://wiki.archlinux.org/index.php?title=Installation_Guide&diff=253744&oldid=250715">👉Wiki</a></p><h4 id="配置系统"><a href="#配置系统" class="headerlink" title="配置系统"></a>配置系统</h4><h5 id="Fstab"><a href="#Fstab" class="headerlink" title="Fstab"></a>Fstab</h5><p>生成 fstab 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</span><br></pre></td></tr></table></figure><p>检查一下生成的 <code>/mnt/etc/fstab</code> 文件是否正确（正确的该是你的分区情况表）</p><h5 id="Chroot"><a href="#Chroot" class="headerlink" title="Chroot"></a>Chroot</h5><p>Change root 到新安装的系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arch-chroot /mnt</span><br></pre></td></tr></table></figure><h5 id="时区"><a href="#时区" class="headerlink" title="时区"></a>时区</h5><p>设置时区：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure><p>运行 <code>hwclock</code> 以生成 <code>/etc/adjtime</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwclock --systohc</span><br></pre></td></tr></table></figure><h5 id="本地化"><a href="#本地化" class="headerlink" title="本地化"></a>本地化</h5><p>本地化的程序与库若要本地化文本，都依赖 Locale，后者明确规定地域、货币、时区日期的格式、字符排列方式和其他本地化标准。<br>需在这两个文件设置：locale.gen 与 locale.conf。  </p><p>编辑/etc/locale.gen 然后移除需要的 地区 前的注释符号 <code>#</code>。  </p><p>接着执行 locale-gen 以生成 locale 信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locale-gen</span><br></pre></td></tr></table></figure><p>然后还需要设置LANG环境变量：  </p><blockquote><p>新建<code>/etc/locale.conf</code>并写入<code>LANG=en_US.UTF-8</code></p></blockquote><h5 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h5><p>设置主机名：</p><blockquote><p>创建<code>/etc/hostname</code>并写入主机名</p></blockquote><p>添加对应的信息到 hosts（ <code>/etc/hosts</code> ）:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 localhost</span><br><span class="line">::1       localhost</span><br><span class="line">127.0.1.1 主机名.localdomain 主机名</span><br></pre></td></tr></table></figure><p>然后：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> dhcpcd.service</span><br><span class="line"><span class="comment"># 我这里提示不存在，于是：</span></span><br><span class="line">pacman -S dhcpcd</span><br></pre></td></tr></table></figure><h5 id="设置root密码"><a href="#设置root密码" class="headerlink" title="设置root密码"></a>设置<code>root</code>密码</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd</span><br></pre></td></tr></table></figure><h5 id="Boot-loader👈"><a href="#Boot-loader👈" class="headerlink" title="Boot loader👈"></a>Boot loader👈</h5><blockquote><p>需要安装 <code>Linux</code> 引导加载程序,才能在安装后启动系统，可以使用的的引导程序已在 <a href="https://wiki.archlinux.org/index.php/Boot_loaders_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">启动加载器</a> 中列出，请选择一个安装并配置它，<a href="https://wiki.archlinux.org/index.php/GRUB">GRUB</a> 是最常见的选择。</p></blockquote><p>方案一：<br>安装 <code>grub</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pacman -S grub</span><br><span class="line">grub-install /dev/sda</span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure><p>方案二：<br>安装 <code>rEFInd</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -S refind-efi</span><br><span class="line">refind-install</span><br></pre></td></tr></table></figure><p>对 <code>/boot/refind_linux.conf</code> 进行编辑：原：  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/08.png" class="" title="before">  <p>修改后：  </p><img src="/2020/09/10/Install-arch-Linux-in-VMware/09.png" class="" title="now">  <h4 id="创建新用户"><a href="#创建新用户" class="headerlink" title="创建新用户"></a><a href="https://wiki.archlinux.org/index.php/Users_and_groups">创建新用户</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useradd -m -G additional_groups -s login_shell username</span><br><span class="line"><span class="comment"># eg:</span></span><br><span class="line">useradd -m -G wheel -s /bin/bash rick</span><br><span class="line"><span class="comment"># 设置密码：</span></span><br><span class="line">passwd username</span><br></pre></td></tr></table></figure><p>为使在 <code>wheel</code> 组中的普通用户能够获得临时的root权限，需要修改 wheel 的权限设置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">visudo</span><br><span class="line"><span class="comment"># 去掉行 `#%wheel ALL=(ALL) ALL` 前的 `#`</span></span><br></pre></td></tr></table></figure><h3 id="收尾"><a href="#收尾" class="headerlink" title="收尾"></a>收尾</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 退出`arch-chroot`:</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="comment"># 卸载根目录</span></span><br><span class="line">umount -R /mnt</span><br><span class="line"><span class="comment"># 然后，重启：</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>幸运儿应该看到这个：😁</p><img src="/2020/09/10/Install-arch-Linux-in-VMware/10.png" class="" title="grub引导界面">  <img src="/2020/09/10/Install-arch-Linux-in-VMware/11.png" class="" title="refind引导界面">  <h3 id="install-Gnome"><a href="#install-Gnome" class="headerlink" title="install Gnome"></a>install Gnome</h3><h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><ul><li>以普通用户登录</li><li><a href="https://wiki.archlinux.org/index.php/Mirrors">选择和配置镜像</a> （安装arch过程中用的原始list，挺顺畅的，但到Gnome时全部404）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># location: /etc/pacman.d/mirrorlist</span></span><br><span class="line"><span class="comment"># 附上几个源： </span></span><br><span class="line">Server = http://mirrors.aliyun.com/archlinux/<span class="variable">$repo</span>/os/<span class="variable">$arch</span>  <span class="comment">#阿里</span></span><br><span class="line">Server = http://mirrors.ustc.edu.cn/archlinux/<span class="variable">$repo</span>/os/<span class="variable">$arch</span>  <span class="comment">#中科大</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></li></ul><h4 id="升级软件包"><a href="#升级软件包" class="headerlink" title="升级软件包"></a>升级软件包</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个 pacman 命令就可以升级整个系统。</span></span><br><span class="line">pacman -Syu</span><br></pre></td></tr></table></figure><h4 id="安装Xorg"><a href="#安装Xorg" class="headerlink" title="安装Xorg"></a>安装Xorg</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S xorg</span><br></pre></td></tr></table></figure><blockquote><p>摘自 <a href="http://www.x.org/wiki/">http://www.x.org/wiki/</a>:<br>X.Org 项目提供了 X 窗口系统的开源实现。开发工作是在 freedesktop.org 社区的通力合作下完成。X.Org 组织是非盈利教育机构。<br> Xorg 在 Linux 用户中非常流行，已经成为图形用户程序的必备条件，所以大部分发行版都提供了它。详情参见 <a href="https://en.wikipedia.org/wiki/X.Org_Server">Xorg</a> 维基文章或访问<a href="http://www.x.org/wiki/">Xorg 网站</a> 。 </p></blockquote><p><del>#### 安装显卡驱动</del></p><p><strong>虚拟机没必要啊，似乎？！</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看显卡类型</span></span><br><span class="line">lspci |grep VGA</span><br><span class="line"><span class="comment"># 安装对应显卡驱动</span></span><br><span class="line">pacman -S xf86-video-xxx（nv,vmware,...）</span><br></pre></td></tr></table></figure><h4 id="安装Gnome与gdm"><a href="#安装Gnome与gdm" class="headerlink" title="安装Gnome与gdm"></a>安装<code>Gnome</code>与<code>gdm</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pacman -S gnome gnome-tweak-tool gdm</span><br><span class="line"><span class="comment"># 开机启动GDM服务</span></span><br><span class="line">systemctl <span class="built_in">enable</span> gdm.service</span><br><span class="line">reboot</span><br><span class="line"><span class="comment"># 就🆗了。。</span></span><br></pre></td></tr></table></figure><p>Gnome我居然也整了两三次，当时装好一直在“锁屏+解锁”，给我难受的😫；<br>然后一不小心看到了 <code>图形内存！！！</code> ，才256MB,原因一定在这了！！！😰</p><h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><p><a href="https://wiki.archlinux.org/index.php/Arch_is_the_best">Arch is the best!</a></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://wiki.archlinux.org/">ArchWiki</a></li><li><a href="https://chaseafterstart.github.io/">chaseafterstart</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ArchLinux </tag>
            
            <tag> VMware </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
